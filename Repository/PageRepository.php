<?php

namespace Softlogo\CMSBundle\Repository;

use Doctrine\ORM\EntityRepository;

/**
 * PageRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class PageRepository extends EntityRepository
{
	public function findBySiteName($name){
		$qb = $this->createQueryBuilder('p')
			->join('p.site', 's');
        $qb->andWhere('s.name= :name')
            ->setParameter('name', $name);
		return $qb;
	}
	public function findSitePage($site, $anchor){
		$qb = $this->createQueryBuilder('p')
			->join('p.site', 's');
		$qb->andWhere('s.name= :site')
			->setParameter('site', $site);
        $qb->andWhere('p.anchor= :anchor')
            ->setParameter('anchor', $anchor);
		$query=$qb->getQuery();
		$sql=$query->getSQL();
		//echo($sql);
		return $query->getResult()[0];
	}

}
